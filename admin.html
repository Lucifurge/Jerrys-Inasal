<!DOCTYPE html>
<html>
<head>
  <title>Order Panel</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="p-4">
  <h2 class="text-success mb-4">Order Management Panel</h2>
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-success">
        <tr>
          <th>Dish</th>
          <th>Location</th>
          <th>Date</th>
          <th>Time</th>
          <th>Contact</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="orderTableBody"></tbody>
    </table>
  </div>

  <script>
    const supabase = supabase.createClient('https://YOUR_PROJECT.supabase.co', 'YOUR_PUBLIC_ANON_KEY');

    async function fetchOrders() {
      const { data, error } = await supabase.from('orders').select('*');
      const tbody = document.getElementById('orderTableBody');
      tbody.innerHTML = '';

      if (error) {
        console.error('Error fetching orders:', error);
        return;
      }

      data.forEach(order => {
        tbody.innerHTML += `
          <tr>
            <td>${order.dish}</td>
            <td>${order.location}</td>
            <td>${order.date}</td>
            <td>${order.time}</td>
            <td>${order.contact || '-'}</td>
            <td>${order.status || 'Pending'}</td>
            <td>
              <button class="btn btn-sm btn-success me-1" onclick="markDone('${order.id}')">Done</button>
              <button class="btn btn-sm btn-danger" onclick="deleteOrder('${order.id}')">Delete</button>
            </td>
          </tr>
        `;
      });
    }

    async function markDone(id) {
      await supabase.from('orders').update({ status: 'Completed' }).eq('id', id);
      fetchOrders();
    }

    async function deleteOrder(id) {
      await supabase.from('orders').delete().eq('id', id);
      fetchOrders();
    }

    fetchOrders();
  </script>
</body>
</html>
